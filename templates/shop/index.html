{% extends 'shop/base.html' %}
{% load static %}

{% block title %}Accueil - Terroir & Saveurs{% endblock %}

{% block search %}
<div class="search-container">
    <form method="GET" class="search-box">
        <input 
            type="text" 
            name="item-name" 
            placeholder="Rechercher des produits (b≈ìuf, volaille, charcuterie...)"
            value="{{ request.GET.item-name }}"
        >
        <button type="submit">Rechercher</button>
    </form>
</div>
{% endblock %}

{% block extra_css %}
<style>
    /* Hero Section */
    .hero {
        background: linear-gradient(135deg, rgba(44, 24, 16, 0.95) 0%, rgba(61, 35, 23, 0.95) 100%),
                    url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 400"><rect fill="%23f5f0e8" width="1200" height="400"/><path fill="%23e8dfd0" d="M0 300L50 280C100 260 200 220 300 200C400 180 500 180 600 200C700 220 800 260 900 280C1000 300 1100 300 1150 300L1200 300L1200 400L1150 400C1100 400 1000 400 900 400C800 400 700 400 600 400C500 400 400 400 300 400C200 400 100 400 50 400L0 400Z"/></svg>');
        background-size: cover;
        background-position: center;
        color: white;
        padding: 4rem 2rem;
        text-align: center;
        margin: -3rem -2rem 3rem -2rem;
        position: relative;
        overflow: hidden;
    }

    .hero::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: 
            radial-gradient(circle at 20% 50%, rgba(212, 175, 55, 0.1) 0%, transparent 50%),
            radial-gradient(circle at 80% 50%, rgba(139, 69, 19, 0.1) 0%, transparent 50%);
        pointer-events: none;
    }

    .hero-content {
        max-width: 800px;
        margin: 0 auto;
        position: relative;
        z-index: 1;
    }

    .hero h1 {
        font-family: 'Playfair Display', serif;
        font-size: 3.5rem;
        font-weight: 700;
        margin-bottom: 1rem;
        letter-spacing: 1px;
        animation: fadeInUp 0.8s ease-out;
    }

    .hero p {
        font-size: 1.4rem;
        margin-bottom: 2rem;
        opacity: 0.95;
        animation: fadeInUp 0.8s ease-out 0.2s backwards;
    }

    .hero-badges {
        display: flex;
        justify-content: center;
        gap: 2rem;
        flex-wrap: wrap;
        animation: fadeInUp 0.8s ease-out 0.4s backwards;
    }

    .badge {
        background: rgba(255, 255, 255, 0.15);
        backdrop-filter: blur(10px);
        padding: 0.8rem 1.5rem;
        border-radius: 50px;
        border: 1px solid rgba(255, 255, 255, 0.2);
        font-size: 1rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    /* Section Title */
    .section-title {
        font-family: 'Playfair Display', serif;
        font-size: 2.5rem;
        text-align: center;
        margin-bottom: 3rem;
        color: var(--primary);
        position: relative;
        padding-bottom: 1rem;
    }

    .section-title::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 50%;
        transform: translateX(-50%);
        width: 100px;
        height: 3px;
        background: linear-gradient(90deg, transparent, var(--accent), transparent);
    }

    /* Products Grid */
    .products-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 2rem;
        margin-bottom: 3rem;
    }

    .product-card {
        background: white;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 5px 20px rgba(0,0,0,0.08);
        transition: all 0.4s ease;
        position: relative;
        animation: fadeInUp 0.6s ease-out backwards;
    }

    .product-card:nth-child(1) { animation-delay: 0.1s; }
    .product-card:nth-child(2) { animation-delay: 0.2s; }
    .product-card:nth-child(3) { animation-delay: 0.3s; }
    .product-card:nth-child(4) { animation-delay: 0.4s; }

    .product-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 15px 40px rgba(139, 69, 19, 0.15);
    }

    .product-image-container {
        position: relative;
        height: 250px;
        overflow: hidden;
        background: linear-gradient(135deg, #f5f0e8 0%, #e8dfd0 100%);
    }

    .product-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.5s ease;
    }

    .product-card:hover .product-image {
        transform: scale(1.1);
    }

    .product-badge {
        position: absolute;
        top: 15px;
        right: 15px;
        background: var(--accent);
        color: var(--primary);
        padding: 0.5rem 1rem;
        border-radius: 50px;
        font-weight: 600;
        font-size: 0.9rem;
        box-shadow: 0 3px 10px rgba(0,0,0,0.2);
    }

    .product-info {
        padding: 1.5rem;
    }

    .product-category {
        color: var(--secondary);
        font-size: 0.9rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-bottom: 0.5rem;
    }

    .product-name {
        font-family: 'Playfair Display', serif;
        font-size: 1.5rem;
        font-weight: 600;
        color: var(--text);
        margin-bottom: 0.5rem;
        line-height: 1.3;
    }

    .product-description {
        color: var(--text-light);
        font-size: 1rem;
        margin-bottom: 1rem;
        line-height: 1.6;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }

    .product-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding-top: 1rem;
        border-top: 1px solid var(--border);
    }

    .product-price {
        font-family: 'Playfair Display', serif;
        font-size: 1.8rem;
        font-weight: 700;
        color: var(--secondary);
    }

    .product-price span {
        font-size: 1rem;
        color: var(--text-light);
        font-weight: 400;
    }

    .product-actions {
        display: flex;
        gap: 0.5rem;
    }

    .btn {
        padding: 0.7rem 1.2rem;
        border-radius: 50px;
        border: none;
        cursor: pointer;
        font-weight: 600;
        font-size: 0.95rem;
        transition: all 0.3s ease;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
    }

    .btn-primary {
        background: var(--secondary);
        color: white;
    }

    .btn-primary:hover {
        background: var(--primary);
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(44, 24, 16, 0.3);
    }

    .btn-secondary {
        background: var(--accent);
        color: var(--primary);
    }

    .btn-secondary:hover {
        background: var(--primary);
        color: white;
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(212, 175, 55, 0.3);
    }

    .btn-icon {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: var(--cream);
        border: 2px solid var(--border);
        color: var(--secondary);
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .btn-icon:hover {
        background: var(--secondary);
        color: white;
        border-color: var(--secondary);
        transform: scale(1.1);
    }

    /* Pagination */
    .pagination {
        display: flex;
        justify-content: center;
        gap: 0.5rem;
        margin-top: 3rem;
    }

    .pagination a,
    .pagination span {
        padding: 0.7rem 1.2rem;
        background: white;
        border: 2px solid var(--border);
        border-radius: 10px;
        color: var(--text);
        text-decoration: none;
        font-weight: 600;
        transition: all 0.3s ease;
    }

    .pagination a:hover {
        background: var(--secondary);
        color: white;
        border-color: var(--secondary);
        transform: translateY(-2px);
    }

    .pagination .current {
        background: var(--secondary);
        color: white;
        border-color: var(--secondary);
    }

    /* Empty State */
    .empty-state {
        text-align: center;
        padding: 4rem 2rem;
    }

    .empty-state-icon {
        font-size: 5rem;
        margin-bottom: 1rem;
    }

    .empty-state h2 {
        font-family: 'Playfair Display', serif;
        font-size: 2rem;
        color: var(--text);
        margin-bottom: 1rem;
    }

    .empty-state p {
        color: var(--text-light);
        font-size: 1.2rem;
    }

    /* Responsive */
    @media (max-width: 768px) {
        .hero h1 {
            font-size: 2rem;
        }

        .hero p {
            font-size: 1.1rem;
        }

        .products-grid {
            grid-template-columns: 1fr;
        }

        .section-title {
            font-size: 2rem;
        }
    }
</style>
{% endblock %}

{% block content %}
<!-- Hero Section -->
<div class="hero">
    <div class="hero-content">
        <h1>Produits de Qualit√© Premium</h1>
        <p>Viandes, charcuterie, volaille et produits laitiers s√©lectionn√©s avec soin</p>
        <div class="hero-badges">
            <div class="badge">‚úì Fra√Æcheur Garantie</div>
            <div class="badge">‚úì Livraison Rapide</div>
            <div class="badge">‚úì Origine Trac√©e</div>
        </div>
    </div>
</div>

{% if produits %}
    <h2 class="section-title">Nos Produits</h2>
    
    <div class="products-grid">
        {% for produit in produits %}
        <div class="product-card">
            <div class="product-image-container">
                {% if produit.image %}
                    <img src="{{ produit.image.url }}" alt="{{ produit.nom }}" class="product-image">
                {% else %}
                    <img src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 400 300'><rect fill='%23f5f0e8' width='400' height='300'/><text x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' font-family='Arial' font-size='24' fill='%23999'>{{ produit.nom|slice:':1' }}</text></svg>" alt="{{ produit.nom }}" class="product-image">
                {% endif %}
                <div class="product-badge">Premium</div>
            </div>
            
            <div class="product-info">
                <div class="product-category">{{ produit.categorie.name }}</div>
                <h3 class="product-name">{{ produit.nom }}</h3>
                <p class="product-description">{{ produit.description|truncatewords:15 }}</p>
                
                <div class="product-footer">
                    <div class="product-price">
                        {{ produit.prix|floatformat:0 }} <span>FCFA</span>
                    </div>
                    <div class="product-actions">
                        <button 
                            class="btn btn-secondary" 
                            onclick="addToCart({{ produit.id }}, '{{ produit.nom|escapejs }}', {{ produit.prix }}, '{% if produit.image %}{{ produit.image.url }}{% endif %}')"
                        >
                            üõí Ajouter
                        </button>
                        <a href="{% url 'detail' produit.id %}" class="btn-icon" title="Voir d√©tails">
                            üëÅÔ∏è
                        </a>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- Pagination -->
    {% if produits.has_other_pages %}
    <div class="pagination">
        {% if produits.has_previous %}
            <a href="?page=1{% if request.GET.item-name %}&item-name={{ request.GET.item-name }}{% endif %}">¬´ Premi√®re</a>
            <a href="?page={{ produits.previous_page_number }}{% if request.GET.item-name %}&item-name={{ request.GET.item-name }}{% endif %}">‚Äπ Pr√©c√©dente</a>
        {% endif %}

        {% for num in produits.paginator.page_range %}
            {% if produits.number == num %}
                <span class="current">{{ num }}</span>
            {% elif num > produits.number|add:'-3' and num < produits.number|add:'3' %}
                <a href="?page={{ num }}{% if request.GET.item-name %}&item-name={{ request.GET.item-name }}{% endif %}">{{ num }}</a>
            {% endif %}
        {% endfor %}

        {% if produits.has_next %}
            <a href="?page={{ produits.next_page_number }}{% if request.GET.item-name %}&item-name={{ request.GET.item-name }}{% endif %}">Suivante ‚Ä∫</a>
            <a href="?page={{ produits.paginator.num_pages }}{% if request.GET.item-name %}&item-name={{ request.GET.item-name }}{% endif %}">Derni√®re ¬ª</a>
        {% endif %}
    </div>
    {% endif %}

{% else %}
    <div class="empty-state">
        <div class="empty-state-icon">üîç</div>
        <h2>Aucun produit trouv√©</h2>
        <p>Essayez une autre recherche ou parcourez toutes nos cat√©gories</p>
        <a href="{% url 'home' %}" class="btn btn-primary" style="margin-top: 1.5rem;">Voir tous les produits</a>
    </div>
{% endif %}
{% endblock %}